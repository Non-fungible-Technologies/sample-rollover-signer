{"version":3,"sources":["App.js","config.js","ExecuteRollover.js","mm_logo.svg","use-pawn-lender.js","usePawnBorrower.js","Unwrap.js","usePayLoan.js","useApproveERC20.js","BorrowerLoanCard.js","reportWebVitals.js","index.js"],"names":["ALCHEMY","App","useConnect","data","useAccount","disconnect","console","log","connected","className","style","border","color","onClick","path","element","Landing","SignerContainer","SubmitContainer","to","replace","ConnectPrompt","chainInfo","usePawnLender","useSigner","signer","wethContract","useContract","addressOrName","addresses","tokens","weth","contractInterface","erc20ABI","signerOrProvider","usdcContract","usdc","useWaitForTransaction","skip","wait","window","approveWETH","a","target","originationController","approve","ethers","constants","MaxInt256","hash","waitForApproval","confirmations","toast","promise","pending","success","error","response","approveUSDC","backgroundColor","loans","map","loan","i","LoanCard","index","borrowerChainInfo","usePawnBorrower","assetWrapperAddress","custom","curatedAW","bundleId","background","padding","key","loanId","terms","useState","showRollover","setShowRollover","toString","legacy","borrower","utils","formatUnits","principal","payableTokenDecimals","payableTokenSymbol","interest","CollateralList","collateral","RolloverSigningForm","oldTerms","erc20","c","amount","decimals","symbol","tokenAddress","erc721","tokenName","tokenId","toNumber","erc1155","prorated","durationSecs","principalBase","Number","interestBase","apr","initialState","duration","setTerms","updateForm","e","value","totalInterest","parseInt","doSigning","typedLoanTermsData","LoanTerms","name","type","domainData","verifyingContract","version","chainId","newLoanTerms","parseUnits","toFixed","collateralTokenId","payableCurrency","fromRpcSig","_signTypedData","sig","payload","lender","contracts","sourceLoanCore","contractAddresses","loanCore","current","targetLoanCore","sourceRepaymentController","repaymentController","targetOriginationController","signature","v","r","Buffer","from","s","metadata","dueDate","moment","add","toISOString","blob","Blob","JSON","stringify","saveAs","Date","now","onChange","format","connect","connectors","wc","cursor","src","MMLogo","alt","instructions","lastDeploy","Main","InjectedConnector","defaultChains","options","shimDisconnect","WalletConnectConnector","rpc","1","qrcode","provider","providers","AlchemyProvider","position","lenderNote","borrowerNote","common","assetWrapper","flashRollover","ExecuteRollover","setPayload","selectedFile","setSelectedFile","isFilePicked","setIsFilePicked","RepaymentControllerAbi","flashRolloverContract","promissoryNoteAbi","FlashRolloverAbi","assetWrapperContract","AssetWrapperAbi","loanCoreContract","loanCoreAbi","doRollover","Uint8Array","atob","charCodeAt","rolloverLoan","gasLimit","rolloverHash","waitdoRollover","d","parse","fromNow","event","files","reader","FileReader","addEventListener","result","readAsText","disabled","useProvider","account","address","setChainInfo","useEffect","legacyLenderNote","Contract","LegacyPromissoryNoteAbi","PromissoryNoteAbi","legacyLoanCore","LegacyLoanCoreAbi","LoanCoreAbi","ERC20Abi","getBalance","ethBalance","balanceOf","usdcBalance","wethBalance","numLenderNotes","numLegacyLenderNotes","tokenOfOwnerByIndex","lenderNoteId","loanIdByNoteId","getLoan","loanData","borrowerNoteId","state","erc20Holdings","erc721Holdings","erc1155Holdings","failed","bundleERC20Holdings","holding","token","push","bundleERC721Holdings","ERC721Abi","bundleERC1155Holdings","ERC1155Abi","payableToken","payableTokenName","info","balances","eth","Object","assign","getInfo","legacyBorrowerNote","numBorrowerNote","numLegacyBorrowerNote","Unwrap","awContract","awAbi","onWithdraw","withdraw","usePayLoan","repaymentContract","spender","erc20Contract","doApprove","useApproveERC20","doRepay","repay","BorrowerLoanCard","borrowerNoteLookupKey","borrowerNoteContract","approveNote","noteId","display","justifyContent","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4e10eb1d.chunk.js","sourcesContent":["import { useState } from \"react\";\n// import { useWallet, UseWalletProvider } from \"use-wallet\";\nimport { ethers, providers } from \"ethers\";\nimport { saveAs } from \"file-saver\";\nimport { fromRpcSig } from \"ethereumjs-util\";\nimport moment from \"moment\";\nimport FlashRolloverAbi from \"./abis/flash-rollover.json\";\nimport RepaymentControllerAbi from \"./abis/repayment-controller.json\";\nimport AssetWrapperAbi from \"./abis/asset-wrapper.json\";\nimport loanCoreAbi from \"./abis/loan-core.json\";\nimport { addresses } from \"./config\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport {\n  Provider,\n  chain,\n  defaultChains,\n  useAccount,\n  useSigner,\n  useConnect,\n  useNetwork,\n  useContract,\n  erc20ABI,\n  useWaitForTransaction,\n} from \"wagmi\";\nimport { BorrowerLoanCard } from \"./BorrowerLoanCard\";\nimport { InjectedConnector } from \"wagmi/connectors/injected\";\nimport { BrowserRouter, Navigate, Routes, Route, Link } from \"react-router-dom\";\nimport promissoryNoteAbi from \"./abis/promissory-note.json\";\nimport MMLogo from \"./mm_logo.svg\";\nimport \"./App.css\";\nimport { usePawnLender } from \"./use-pawn-lender\";\nimport { usePawnBorrower } from \"./usePawnBorrower\";\nimport { WalletConnectConnector } from \"wagmi/connectors/walletConnect\";\nimport { ExecuteRollover } from \"./ExecuteRollover\";\nimport { Unwrap } from \"./Unwrap\";\n\nconst ALCHEMY = \"nFgwePbNgrn6330Zsxu7l5oKP_IW5xBg\";\n\nfunction Main() {\n  const provider = ({ chainId }) => {\n    return new providers.AlchemyProvider(chainId, ALCHEMY);\n  };\n  const connectors = ({ chainId }) => {\n    return [\n      new InjectedConnector({\n        defaultChains,\n        options: { shimDisconnect: true },\n      }),\n      new WalletConnectConnector({\n        options: {\n          rpc: {\n            1: `https://eth-mainnet.alchemyapi.io/v2/${ALCHEMY}`,\n          },\n          chainId: 1,\n          qrcode: true,\n        },\n      }),\n    ];\n  };\n  return (\n    <Provider connectors={connectors} provider={provider}>\n      <ToastContainer position=\"top-center\" />\n      <App />\n    </Provider>\n  );\n}\n\nfunction App() {\n  // const account = useAccount();\n  const [{ data }, connect] = useConnect();\n  const [{ data: account }, disconnect] = useAccount();\n\n  console.log(\"rendering\", data?.connected);\n\n  // if (\n  //   data &&\n  //   data?.connectors[0].chainId !== 1 &&\n  //   data?.connectors[0].chainId !== 1337\n  // ) {\n  //   return (\n  //     <div className=\"App\">\n  //       <div className=\"container main\">\n  //         <h1 className=\"bold\">Pawn.fi Rollover Signer</h1>\n  //         <hr />\n  //         <h4 className=\"bold header\">\n  //           Please switch your wallet network to Ethereum mainnet.\n  //         </h4>\n  //       </div>\n  //     </div>\n  //   );\n  // }\n\n  return (\n    <div className=\"App\">\n      <div className=\"container main\">\n        <h1 className=\"header bold\">Arcade Rollover Signer</h1>\n        <hr />\n        {data?.connected ? (\n          <>\n            <button\n              style={{ border: \"1px solid red\", color: \"white\" }}\n              onClick={() => disconnect()}\n            >\n              Disconnect\n            </button>\n            <BrowserRouter>\n              <Routes>\n                <Route path=\"/sample-rollover-signer\" element={<Landing />} />\n                <Route\n                  path=\"/sample-rollover-signer/lender\"\n                  element={<SignerContainer />}\n                />\n                <Route\n                  path=\"/sample-rollover-signer/borrower\"\n                  element={<SubmitContainer />}\n                />\n                <Route\n                  path=\"*\"\n                  element={<Navigate to=\"/sample-rollover-signer\" replace />}\n                />\n              </Routes>\n            </BrowserRouter>\n          </>\n        ) : (\n          <ConnectPrompt />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction Landing() {\n  return (\n    <div className=\"container\">\n      <div className=\"row centered\">\n        <Link to=\"/sample-rollover-signer/lender\">\n          <button className=\"button-primary\">Lender</button>\n        </Link>\n      </div>\n      <div className=\"row centered\">\n        <Link to=\"/sample-rollover-signer/borrower\">\n          <button className=\"button-primary\">Borrower</button>\n        </Link>\n      </div>\n    </div>\n  );\n}\n\nfunction SignerContainer() {\n  // const wallet = useWallet();\n  const chainInfo = usePawnLender();\n  const [{ data: signer }] = useSigner();\n\n  const wethContract = useContract({\n    addressOrName: addresses.tokens.weth,\n    contractInterface: erc20ABI,\n    signerOrProvider: signer,\n  });\n\n  const usdcContract = useContract({\n    addressOrName: addresses.tokens.usdc,\n    contractInterface: erc20ABI,\n    signerOrProvider: signer,\n  });\n\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  window.chainInfo = chainInfo;\n\n  if (!chainInfo) return <h4>Loading...</h4>;\n  console.log({ chainInfo });\n  const approveWETH = async () => {\n    console.log(\n      `approving WETH for ... ${addresses.target.originationController}`\n    );\n    try {\n      const { hash } = await wethContract.approve(\n        addresses.target.originationController,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving WETH...\",\n        success: \"WETH Approved\",\n        error: \"Failed to Approve WETH\",\n      });\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const approveUSDC = async () => {\n    console.log(\n      `approving USDC for...${addresses.target.originationController}`\n    );\n    try {\n      const { hash } = await usdcContract.approve(\n        addresses.target.originationController,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving USDC...\",\n        success: \"USDC Approved\",\n        error: \"Failed to Approve USDC\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  return (\n    <div>\n      <h4>Active Loans</h4>\n      <div>\n        <button\n          onClick={() => approveWETH()}\n          style={{ backgroundColor: \"white\" }}\n        >\n          Approve WETH (OrCtrl)\n        </button>\n        &nbsp; &nbsp;\n        <button\n          onClick={() => approveUSDC()}\n          style={{ backgroundColor: \"white\" }}\n        >\n          Approve USDC (OrCtrl)\n        </button>\n      </div>\n      <ExecuteRollover />\n      {chainInfo.loans.map((loan, i) => (\n        <LoanCard loan={loan} key={i} index={i} chainInfo={chainInfo} />\n      ))}\n    </div>\n  );\n}\n\nfunction SubmitContainer() {\n  // const wallet = useWallet();\n  const borrowerChainInfo = usePawnBorrower();\n  if (!borrowerChainInfo) return <h4>Loading Borrower Loans...</h4>;\n\n  return (\n    <div>\n      <ExecuteRollover />\n      <Unwrap assetWrapperAddress={addresses.custom.curatedAW} bundleId={44} />\n      {borrowerChainInfo &&\n        borrowerChainInfo.loans.map((loan, i) => (\n          <div style={{ background: \"gray\", padding: \"10px\" }}>\n            <BorrowerLoanCard\n              loan={loan}\n              key={i}\n              chainInfo={borrowerChainInfo}\n            />\n          </div>\n        ))}\n    </div>\n  );\n}\n\nfunction LoanCard({ loan, index: key, chainInfo }) {\n  const { loanId, terms, data } = loan;\n  const [showRollover, setShowRollover] = useState(false);\n\n  return (\n    <div className=\"loan card\" key={key}>\n      <h5 className=\"bold\">\n        Loan ID {loanId.toString()}\n        {loan.legacy && ` (Legacy)`}\n      </h5>\n      <p>\n        <strong>Borrower:</strong> {loan.borrower}\n      </p>\n      <p>\n        <strong>Principal:</strong>{\" \"}\n        {ethers.utils.formatUnits(terms.principal, terms.payableTokenDecimals)}{\" \"}\n        {terms.payableTokenSymbol}\n      </p>\n      <p>\n        <strong>Interest:</strong>{\" \"}\n        {ethers.utils.formatUnits(terms.interest, terms.payableTokenDecimals)}{\" \"}\n        {terms.payableTokenSymbol}\n      </p>\n      <CollateralList loanId={loanId} collateral={loan.collateral} />\n      {/* <p>\n        <strong>\n          <DueDate ts={data.dueDate} />\n        </strong>\n      </p> */}\n      <p>\n        <strong>\n          <a\n            className=\"rollover toggle\"\n            onClick={() => setShowRollover(!showRollover)}\n          >\n            {showRollover ? \"Hide\" : \"Rollover Loan\"}\n          </a>\n        </strong>\n      </p>\n      {showRollover && (\n        <RolloverSigningForm\n          loan={loan}\n          oldTerms={terms}\n          chainInfo={chainInfo}\n        />\n      )}\n    </div>\n  );\n}\n\nexport const CollateralList = ({ loanId, collateral }) => {\n  return (\n    <div>\n      <strong>Collateral:</strong>\n      <ul className=\"collateral list\">\n        {collateral.erc20.map((c) => (\n          <li key={loanId + c.tokenAddress + c.amount.toString()}>\n            {ethers.utils.formatUnits(c.amount, c.decimals)} {c.symbol}\n          </li>\n        ))}\n        {collateral.erc721.map((c) => (\n          <li key={loanId + c.tokenAddress + c.tokenId}>\n            {c.tokenName} #{c.tokenId.toNumber()}\n          </li>\n        ))}\n        {collateral.erc1155.map((c) => (\n          <li key={(loanId = c.tokenAddress)}>\n            {c.amount} of {c.tokenName} #{c.tokenId}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nfunction DueDate({ ts }) {\n  const d = moment.unix(ts);\n\n  if (d > Date.now()) {\n    return `Due ${d.fromNow()} (${d.format(\"LLL\")})`;\n  } else {\n    return `Overdue: due ${d.toNow()} (${d.format(\"LLL\")})`;\n  }\n}\n\nexport const RolloverSigningForm = ({ loan, oldTerms, chainInfo }) => {\n  // const wallet = useWallet();\n  const [{ data: signer }] = useSigner();\n\n  window.oldTerms = oldTerms;\n  const SECONDS_IN_YEAR = 31536000;\n  const SECONDS_IN_DAY = 86400;\n  const prorated = oldTerms.durationSecs.toNumber() / SECONDS_IN_YEAR;\n  const principalBase = Number(\n    ethers.utils.formatUnits(oldTerms.principal, oldTerms.payableTokenDecimals)\n  );\n  const interestBase = Number(\n    ethers.utils.formatUnits(oldTerms.interest, oldTerms.payableTokenDecimals)\n  );\n  const apr = (interestBase / principalBase / prorated) * 100;\n  const durationDays = oldTerms.durationSecs.toNumber() / SECONDS_IN_DAY;\n\n  const initialState = {\n    principal: principalBase,\n    interest: interestBase,\n    duration: durationDays,\n    apr,\n  };\n\n  const [terms, setTerms] = useState(initialState);\n\n  const updateForm = (key) => (e) => {\n    setTerms({ ...terms, [key]: e.target.value });\n  };\n\n  window.terms = terms;\n  // window.wallet = wallet;\n\n  const totalInterest =\n    (terms.duration / 365) * (parseInt(terms.apr, 10) / 100) * terms.principal;\n\n  const resetForm = () => setTerms(initialState);\n\n  const doSigning = async () => {\n    const typedLoanTermsData = {\n      LoanTerms: [\n        { name: \"durationSecs\", type: \"uint256\" },\n        { name: \"principal\", type: \"uint256\" },\n        { name: \"interest\", type: \"uint256\" },\n        { name: \"collateralTokenId\", type: \"uint256\" },\n        { name: \"payableCurrency\", type: \"address\" },\n      ],\n      // primaryType: \"LoanTerms\"\n    };\n\n    const domainData = {\n      verifyingContract: addresses.target.originationController,\n      name: \"OriginationController\",\n      version: \"1\",\n      // chainId: wallet.chainId,\n      chainId: \"1\",\n    };\n\n    const newLoanTerms = {\n      durationSecs: terms.duration * SECONDS_IN_DAY,\n      principal: ethers.utils\n        .parseUnits(\n          terms.principal.toFixed(oldTerms.payableTokenDecimals),\n          oldTerms.payableTokenDecimals\n        )\n        .toString(),\n      interest: ethers.utils\n        .parseUnits(\n          totalInterest.toFixed(oldTerms.payableTokenDecimals),\n          oldTerms.payableTokenDecimals\n        )\n        .toString(),\n      collateralTokenId: oldTerms.collateralTokenId.toNumber(),\n      payableCurrency: oldTerms.payableCurrency,\n    };\n\n    // const provider = new ethers.providers.Web3Provider(wallet.ethereum);\n    // const signer = provider.getSigner();\n\n    const sig = fromRpcSig(\n      await signer._signTypedData(domainData, typedLoanTermsData, newLoanTerms)\n    );\n\n    // Generate EIP-712 signature to sign\n    // Download terms and signature as JSON\n    const payload = {\n      legacy: loan.legacy,\n      borrower: loan.borrower,\n      lender: loan.lender,\n      contracts: {\n        sourceLoanCore: loan.legacy\n          ? chainInfo.contractAddresses.legacy.loanCore\n          : chainInfo.contractAddresses.current.loanCore,\n        targetLoanCore: addresses.target.loanCore,\n        sourceRepaymentController: loan.legacy\n          ? chainInfo.contractAddresses.legacy.repaymentController\n          : chainInfo.contractAddresses.current.repaymentController,\n        targetOriginationController: addresses.target.originationController,\n      },\n      loanId: loan.loanId.toString(),\n      newLoanTerms,\n      signature: {\n        v: sig.v,\n        r: Buffer.from(sig.r).toString(\"base64\"),\n        s: Buffer.from(sig.s).toString(\"base64\"),\n      },\n      // collateral: loan.collateral,\n      metadata: {\n        totalInterest,\n        payableTokenDecimals: oldTerms.payableTokenDecimals,\n        payableTokenSymbol: oldTerms.payableTokenSymbol,\n        dueDate: moment().add(terms.duration, \"days\").toISOString(),\n      },\n    };\n\n    const blob = new Blob([JSON.stringify(payload, null, 4)], {\n      type: \"text/plain;charset=utf-8\",\n    });\n\n    saveAs(blob, `rollover_data_${Date.now()}.json`);\n  };\n\n  return (\n    <div className=\"rollover-form\">\n      <div className=\"row\">\n        <form>\n          <div className=\"row\">\n            <div className=\"four columns\">\n              <label>Principal</label>\n            </div>\n            <div className=\"six columns\">\n              <input\n                type=\"number\"\n                onChange={updateForm(\"principal\")}\n                value={terms.principal}\n              />\n            </div>\n            <div className=\"two columns\">\n              <strong>{oldTerms.payableTokenSymbol}</strong>\n            </div>\n          </div>\n          <div className=\"row input-row\">\n            <div className=\"four columns\">\n              <label>APR</label>\n            </div>\n            <div className=\"six columns\">\n              <input\n                type=\"number\"\n                onChange={updateForm(\"apr\")}\n                value={terms.apr}\n              />\n            </div>\n            <div className=\"two columns\">\n              <strong>%</strong>\n            </div>\n          </div>\n          <div className=\"row total-interest-row\">\n            <div className=\"four columns\">\n              <em>Total Interest:</em>\n            </div>\n            <div className=\"six columns\">\n              <em>\n                {totalInterest} {oldTerms.payableTokenSymbol}\n              </em>\n            </div>\n          </div>\n          <div className=\"row input-row\">\n            <div className=\"four columns\">\n              <label>Duration</label>\n            </div>\n            <div className=\"six columns\">\n              {/* TODO: Put implicit due date */}\n              <input\n                type=\"number\"\n                onChange={updateForm(\"duration\")}\n                value={terms.duration}\n              />\n            </div>\n            <div className=\"two columns\">\n              <strong>Days</strong>\n            </div>\n            <div className=\"row total-interest-row\">\n              <div className=\"four columns\">\n                <em>Due Date:</em>\n              </div>\n              <div className=\"six columns\">\n                <em>{moment().add(terms.duration, \"days\").format(\"LL\")}</em>\n              </div>\n            </div>\n          </div>\n        </form>\n      </div>\n      <div className=\"row button-container\">\n        <div className=\"six columns\">\n          <button className=\"button reset-button\" onClick={resetForm}>\n            Reset\n          </button>\n        </div>\n        <div className=\"six columns\">\n          <button className=\"button-primary\" onClick={doSigning}>\n            Sign & Download JSON\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nfunction ConnectPrompt() {\n  const [{ data }, connect] = useConnect();\n  const [mm, wc] = data?.connectors;\n  return (\n    <div className=\"centered\">\n      <button\n        className=\"connect\"\n        style={{ cursor: \"pointer\" }}\n        onClick={() => connect(data?.connectors[0])}\n      >\n        <img src={MMLogo} alt=\"Metamask\" className=\"mm-logo\" />\n        &nbsp; Connect Metamask\n      </button>\n      &nbsp;&nbsp;\n      <button\n        className=\"connect\"\n        style={{ cursor: \"pointer\" }}\n        onClick={() => connect(wc)}\n      >\n        Wallet Connect\n      </button>\n    </div>\n  );\n}\n\nwindow.instructions = () => {\n  const str = `\nFlash Rollover Prerequisites:\n\n1. Make sure borrower has approved BorrowerNote for withdrawal by flash rollover contract\n2. Make sure lender has approved OriginationController to withdraw tokens\n3. Make sure lender has approved FlashRollover to withdraw tokens\n`;\n\n  console.log(str);\n};\n\nwindow.lastDeploy = \"1230PST 06/02\";\n\nexport default Main;\n","export const addresses = {\n  legacy: {\n    lenderNote: \"0xD96e4D03420aA33a3FE91f57D03D8Ef69dE1e863\",\n    loanCore: \"0x59e57F9A313A2EB1c7357eCc331Ddca14209F403\",\n    repaymentController: \"0x945afF9253C840401166c3d24fF78180Fe0A05df\",\n    originationController: \"0x0585a675029C68A6AF41Ba1350BC8172D6172320\",\n    borrowerNote: \"0x9B458e2B9c0Cd34A62A26B846f45Eb829aEbC96E\",\n  },\n  current: {\n    // lenderNote: \"0x6BD1476dD1D57f08670AF6720CA2eDf37B10746E\",\n    lenderNote: \"0xe1ef2656d965ac9e3fe151312f19f3d4c5f0efa3\",\n    // loanCore: \"0x606E4a441290314aEaF494194467Fd2Bb844064A\",\n    loanCore: \"0x7691EE8feBD406968D46F9De96cB8CC18fC8b325\",\n\n    // repaymentController: \"0x9eCE636e942bCb67f9E0b7B6C51A56570EF6F38d\",\n    repaymentController: \"0xD7B4586b4eD87e2B98aD2df37A6c949C5aB1B1dB\",\n    originationController: \"0x7C2A27485B69f490945943464541236a025161F6\",\n    // borrowerNote: \"0xe00B37ad3a165A66C20cA3E0170e4749c20eF58c\",\n    borrowerNote: \"0xc3231258D6Ed397Dce7a52a27f816c8f41d22151\",\n  },\n  common: {\n    // assetWrapper: \"0x1F563CDd688ad47b75E474FDe74E87C643d129b7\",\n    assetWrapper: \"0x5CB803c31e8f4F895a3AB19d8218646dC63e9Dc2\",\n    flashRollover: \"0x24611Fad669350cA869FBed4B62877d1a409dA12\",\n  },\n  tokens: {\n    usdc: \"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48\",\n    weth: \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\",\n  },\n  target: {\n    originationController: \"0xf72516d0d038Ec8c0Ef0Fe8f7f4EEaD8Ee1c31E2\",\n    flashRollover: \"0x24611Fad669350cA869FBed4B62877d1a409dA12\",\n    // flashRollover: \"0xC06f3ec8601dC3e8116EDd05d5A1721DC2d7250E\",\n    // silver\n    // flashRollover: \"0x27Ed938FF4d532332C2701866D7869EDcB39d7E4\",\n    loanCore: \"0x7691EE8feBD406968D46F9De96cB8CC18fC8b325\",\n    repaymentController: \"0xD7B4586b4eD87e2B98aD2df37A6c949C5aB1B1dB\",\n    borrowerNote: \"0xc3231258D6Ed397Dce7a52a27f816c8f41d22151\",\n    assetWrapper: \"0x5CB803c31e8f4F895a3AB19d8218646dC63e9Dc2\",\n  },\n  custom: {\n    curatedAW: \"0xdba0198f9693486ef88fdc78aef40e975aad9fcb;\",\n  },\n};\n","import { ethers } from \"ethers\";\nimport { useSigner, useContract, erc20ABI, useWaitForTransaction } from \"wagmi\";\nimport { useState } from \"react\";\nimport RepaymentControllerAbi from \"./abis/repayment-controller.json\";\nimport promissoryNoteAbi from \"./abis/promissory-note.json\";\nimport FlashRolloverAbi from \"./abis/flash-rollover.json\";\nimport AssetWrapperAbi from \"./abis/asset-wrapper.json\";\nimport loanCoreAbi from \"./abis/loan-core.json\";\nimport { toast } from \"react-toastify\";\nimport { addresses } from \"./config\";\nimport moment from \"moment\";\n\nexport const ExecuteRollover = () => {\n  // const wallet = useWallet();\n  // const borrowerChainInfo = usePawnBorrower();\n\n  const [{ data: signer }] = useSigner();\n  const [payload, setPayload] = useState(null);\n  const [selectedFile, setSelectedFile] = useState();\n  const [isFilePicked, setIsFilePicked] = useState(false);\n  const [repayNoteId, setRepayNoteId] = useState();\n  const [withdrawTokenId, setWithdrawTokenId] = useState();\n\n  const wethContract = useContract({\n    addressOrName: addresses.tokens.weth,\n    contractInterface: erc20ABI,\n    signerOrProvider: signer,\n  });\n\n  const repaymentContract = useContract({\n    addressOrName: addresses.target.repaymentController,\n    contractInterface: RepaymentControllerAbi,\n    signerOrProvider: signer,\n  });\n\n  const usdcContract = useContract({\n    addressOrName: addresses.tokens.usdc,\n    contractInterface: erc20ABI,\n    signerOrProvider: signer,\n  });\n\n  const borrowerNoteContract = useContract({\n    addressOrName: addresses.current.borrowerNote,\n    contractInterface: promissoryNoteAbi,\n    signerOrProvider: signer,\n  });\n\n  const flashRolloverContract = useContract({\n    addressOrName: addresses.target.flashRollover,\n    contractInterface: FlashRolloverAbi,\n    signerOrProvider: signer,\n  });\n\n  const assetWrapperContract = useContract({\n    addressOrName: addresses.target.assetWrapper,\n    contractInterface: AssetWrapperAbi,\n    signerOrProvider: signer,\n  });\n\n  const loanCoreContract = useContract({\n    addressOrName: addresses.target.loanCore,\n    contractInterface: loanCoreAbi,\n    signerOrProvider: signer,\n  });\n\n  console.log({ assetWrapperContract });\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  console.log({ contracts: { assetWrapperContract, loanCoreContract } });\n\n  window.payload = payload;\n  const approveWETH = async () => {\n    console.log(\"approving WETH...\");\n    try {\n      const { hash } = await wethContract.approve(\n        addresses.target.flashRollover,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving WETH...\",\n        success: \"WETH Approved\",\n        error: \"Failed to Approve WETH\",\n      });\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const approveUSDC = async () => {\n    console.log(`approving USDC...${addresses.target.flashRollover}`);\n    try {\n      const { hash } = await usdcContract.approve(\n        addresses.target.flashRollover,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving USDC...\",\n        success: \"USDC Approved\",\n        error: \"Failed to Approve USDC\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const approveWETHRepay = async () => {\n    console.log(\"approving weth...\");\n    try {\n      const { hash } = await wethContract.approve(\n        addresses.target.repaymentController,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving weth...\",\n        success: \"weth Approved\",\n        error: \"Failed to Approve weth\",\n      });\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const approveUSDCRepay = async () => {\n    console.log(\"approving usdc...\");\n    try {\n      const { hash } = await usdcContract.approve(\n        addresses.target.repaymentController,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving usdc...\",\n        success: \"usdc Approved\",\n        error: \"Failed to Approve WETH\",\n      });\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const changeHandler = (event) => {\n    setSelectedFile(event.target.files[0]);\n    setIsFilePicked(true);\n  };\n\n  const handleSubmission = () => {\n    // Parse and set payload\n    const reader = new FileReader();\n\n    reader.addEventListener(\"load\", () => {\n      const payload = JSON.parse(reader.result);\n      setPayload(payload);\n    });\n\n    reader.readAsText(selectedFile);\n  };\n\n  const onRepay = async () => {\n    console.log(`repaying with...${addresses.target.repaymentController}`);\n    try {\n      const { hash } = await repaymentContract.repay(2);\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Repaying...\",\n        success: \"Repaid\",\n        error: \"Failed to repay\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  const onWithdraw = async () => {\n    console.log(`withdrawing from ... ${addresses.target.assetWrapper}`);\n\n    try {\n      const { hash } = await assetWrapperContract.withdraw(103);\n\n      const waitForTx = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForTx, {\n        pending: \"Withdrawing...\",\n        success: \"Success\",\n        error: \"Failed to Withdraw\",\n      });\n    } catch (e) {\n      toast.error(\"An Error Occured\");\n      console.log(\"Error \", e);\n    }\n  };\n\n  const doRollover = async () => {\n    // convert sigs to bytes\n    const r = Uint8Array.from(atob(payload.signature.r), (c) =>\n      c.charCodeAt(0)\n    );\n    const s = Uint8Array.from(atob(payload.signature.s), (c) =>\n      c.charCodeAt(0)\n    );\n    console.log(\"###### Payload Rollover :::: \", r, s, payload);\n\n    try {\n      console.log({ flashRolloverContract });\n      const { hash: rolloverHash } = await flashRolloverContract.rolloverLoan(\n        payload.contracts,\n        payload.loanId,\n        payload.newLoanTerms,\n        payload.signature.v,\n        r,\n        s,\n        { gasLimit: \"5000000\" }\n      );\n\n      const waitdoRollover = wait({ confirmations: 1, rolloverHash });\n      const response = await toast.promise(waitdoRollover, {\n        pending: \"Rollover...\",\n        success: \"Rollover Approved\",\n        error: \"Failed to Rollover \",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      console.log(\"ERror \", e);\n      toast.error(e);\n    }\n  };\n\n  if (!payload) {\n    return (\n      <div className=\"execute-container\">\n        <h3>Execute Rollover</h3>\n        {/* <button\n          style={{ background: \"lightgray\" }}\n          onClick={() => approveWETHRepay()}\n        >\n          Approve WETH Repayment\n        </button>\n        &nbsp;&nbsp;\n        <button\n          style={{ background: \"lightgray\" }}\n          onClick={() => approveUSDCRepay()}\n        >\n          Approve USDC Repayment\n        </button>\n        &nbsp;&nbsp;\n        <br />\n        <input\n          value={repayNoteId}\n          size={5}\n          style={{ padding: \"8px\" }}\n          onChange={(ev) => setRepayNoteId(ev.target.value)}\n        />\n        <button style={{ background: \"lightgray\" }} onClick={() => onRepay()}>\n          Repay\n        </button>\n        &nbsp;&nbsp;\n        <input\n          value={withdrawTokenId}\n          style={{ padding: \"8px\" }}\n          size={5}\n          onChange={(ev) => setWithdrawTokenId(ev.target.value)}\n        />\n        <button style={{ background: \"cyan\" }} onClick={() => onWithdraw()}>\n          Withdraw\n        </button> */}\n        <div className=\"row centered\">\n          <input type=\"file\" name=\"file\" onChange={changeHandler} />\n          <button\n            className=\"button-primary\"\n            onClick={handleSubmission}\n            disabled={!isFilePicked}\n          >\n            Upload JSON\n          </button>\n        </div>\n        <div>\n          <button\n            onClick={() => approveWETH()}\n            style={{ backgroundColor: \"white\" }}\n          >\n            Approve WETH (Rollover)\n          </button>\n          &nbsp; &nbsp;\n          <button\n            onClick={() => approveUSDC()}\n            style={{ backgroundColor: \"white\" }}\n          >\n            Approve USDC (Rollover)\n          </button>\n        </div>\n      </div>\n    );\n  } else {\n    const { loanId, newLoanTerms: terms, legacy, metadata } = payload;\n    const d = moment(Date.parse(metadata.dueDate));\n\n    return (\n      <div className=\"execute-container\">\n        <h3>Execute Rollover</h3>\n        <div className=\"row centered\">\n          <button className=\"button-primary\" onClick={() => setPayload(null)}>\n            Reset\n          </button>\n        </div>\n        <div className=\"row centered\">\n          <div className=\"loan card\">\n            <h5 className=\"bold\">\n              Loan ID {loanId.toString()}\n              {legacy && ` (Legacy)`}\n            </h5>\n            <p>\n              <strong>Principal:</strong>{\" \"}\n              {ethers.utils.formatUnits(\n                terms.principal,\n                metadata.payableTokenDecimals\n              )}{\" \"}\n              {metadata.payableTokenSymbol}\n            </p>\n            <p>\n              <strong>Interest:</strong>{\" \"}\n              {ethers.utils.formatUnits(\n                terms.interest,\n                metadata.payableTokenDecimals\n              )}{\" \"}\n              {metadata.payableTokenSymbol}\n            </p>\n            <p>\n              <strong>{`Due ${d.fromNow()} (${d.format(\"LLL\")})`}</strong>\n            </p>\n            <button className=\"button-primary\" onClick={doRollover}>\n              Rollover\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n};\n","export default __webpack_public_path__ + \"static/media/mm_logo.45038d58.svg\";","import { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\n\nimport LegacyPromissoryNoteAbi from \"./abis/legacy-promissory-note.json\";\nimport LegacyLoanCoreAbi from \"./abis/legacy-loan-core.json\";\nimport PromissoryNoteAbi from \"./abis/promissory-note.json\";\nimport LoanCoreAbi from \"./abis/loan-core.json\";\nimport AssetWrapperAbi from \"./abis/asset-wrapper.json\";\nimport FlashRolloverAbi from \"./abis/flash-rollover.json\";\nimport { useAccount, useConnect, useProvider, useSigner } from \"wagmi\";\nimport ERC20Abi from \"./abis/erc20.json\";\nimport ERC721Abi from \"./abis/erc721.json\";\nimport ERC1155Abi from \"./abis/erc1155.json\";\nimport { addresses } from \"./config\";\n// export const addresses = {\n//     legacy: {\n//         lenderNote: '0xD96e4D03420aA33a3FE91f57D03D8Ef69dE1e863',\n//         loanCore: '0x59e57F9A313A2EB1c7357eCc331Ddca14209F403',\n//         repaymentController: '0x945afF9253C840401166c3d24fF78180Fe0A05df',\n//         originationController: '0x0585a675029C68A6AF41Ba1350BC8172D6172320'\n//     },\n//     current: {\n//         lenderNote: '0x6BD1476dD1D57f08670AF6720CA2eDf37B10746E',\n//         loanCore: '0x606E4a441290314aEaF494194467Fd2Bb844064A',\n//         repaymentController: '0x9eCE636e942bCb67f9E0b7B6C51A56570EF6F38d',\n//         originationController: '0x7C2A27485B69f490945943464541236a025161F6'\n//     },\n//     common: {\n//         assetWrapper: '0x1F563CDd688ad47b75E474FDe74E87C643d129b7',\n//         flashRollover: '0x24611Fad669350cA869FBed4B62877d1a409dA12'\n//     },\n//     tokens: {\n//         usdc: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',\n//         weth: '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2'\n//     }\n// }\n\nexport function usePawnLender() {\n  const provider = useProvider();\n  const [{ data }] = useAccount();\n\n  const account = data?.address;\n\n  const [chainInfo, setChainInfo] = useState(null);\n\n  useEffect(() => {\n    const getInfo = async () => {\n      if (!account) return;\n      console.log(account);\n\n      // Find active loans\n      // For lender note, check owned tokens - for each one, get the loan ID\n      const legacyLenderNote = new ethers.Contract(\n        addresses.legacy.lenderNote,\n        LegacyPromissoryNoteAbi,\n        provider\n      );\n      const lenderNote = new ethers.Contract(\n        addresses.current.lenderNote,\n        PromissoryNoteAbi,\n        provider\n      );\n      // const legacyLenderNote = new ethers.Contract(\n      //   addresses.legacy.borrowerNote,\n      //   LegacyPromissoryNoteAbi,\n      //   provider\n      // );\n      // const lenderNote = new ethers.Contract(\n      //   addresses.current.borrowerNote,\n      //   PromissoryNoteAbi,\n      //   provider\n      // );\n      const legacyBorrowerNote = new ethers.Contract(\n        addresses.legacy.borrowerNote,\n        LegacyPromissoryNoteAbi,\n        provider\n      );\n      const borrowerNote = new ethers.Contract(\n        addresses.current.borrowerNote,\n        PromissoryNoteAbi,\n        provider\n      );\n      const legacyLoanCore = new ethers.Contract(\n        addresses.legacy.loanCore,\n        LegacyLoanCoreAbi,\n        provider\n      );\n      const loanCore = new ethers.Contract(\n        addresses.current.loanCore,\n        LoanCoreAbi,\n        provider\n      );\n      const assetWrapper = new ethers.Contract(\n        addresses.common.assetWrapper,\n        AssetWrapperAbi,\n        provider\n      );\n      const flashRollover = new ethers.Contract(\n        addresses.common.flashRollover,\n        FlashRolloverAbi,\n        provider\n      );\n\n      const usdc = new ethers.Contract(\n        addresses.tokens.usdc,\n        ERC20Abi,\n        provider\n      );\n      const weth = new ethers.Contract(\n        addresses.tokens.weth,\n        ERC20Abi,\n        provider\n      );\n\n      const ethBalance = await provider.getBalance(account);\n      const usdcBalance = await usdc.balanceOf(account);\n      const wethBalance = await weth.balanceOf(account);\n\n      const numLenderNotes = await lenderNote.balanceOf(account);\n      const numLegacyLenderNotes = await legacyLenderNote.balanceOf(account);\n\n      //   console.log(\"BALANCES\", numLenderNotes, numLegacyLenderNotes);\n\n      const loans = [];\n      window.contracts = {\n        assetWrapper,\n        flashRollover,\n        usdc,\n        loanCore,\n        legacyLoanCore,\n        lenderNote,\n        borrowerNote,\n      };\n      for (let i = 0; i < numLenderNotes; i++) {\n        const lenderNoteId = await lenderNote.tokenOfOwnerByIndex(account, i);\n        const loanId = await lenderNote.loanIdByNoteId(lenderNoteId);\n        const loanData = await loanCore.getLoan(loanId);\n        console.log(\"BORORWER NOTE ID\", loanData.borrowerNoteId);\n\n        // Active state\n        if (loanData.state === 2) {\n          // const borrower = await borrowerNote.ownerOf(loanData.borrowerNoteId);\n          // console.log(\"BORORWER\", borrower);\n          // Find collateral\n          const tokenId = loanData.terms.collateralTokenId;\n          const erc20Holdings = [];\n          const erc721Holdings = [];\n          const erc1155Holdings = [];\n\n          let failed = false;\n          let i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC20Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC20Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n              const decimals = await token.decimals();\n\n              erc20Holdings.push({\n                amount: holding.amount,\n                tokenAddress: holding.tokenAddress,\n                token,\n                tokenName,\n                symbol,\n                decimals,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC721Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC721Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc721Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC1155Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC1155Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc1155Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                amount: holding.amount,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          const payableToken = new ethers.Contract(\n            loanData.terms.payableCurrency,\n            ERC20Abi,\n            provider\n          );\n\n          loans.push({\n            legacy: false,\n            loanId: loanId,\n            lender: account,\n            // borrower,\n            data: {\n              state: loanData.state,\n              dueDate: loanData.dueDate.toNumber(),\n              borrowerNoteId: loanData.borrowerNoteId.toNumber(),\n              lenderNoteId: loanData.lenderNoteId.toNumber(),\n            },\n            terms: {\n              collateralTokenId: loanData.terms.collateralTokenId,\n              payableCurrency: loanData.terms.payableCurrency,\n              payableToken: payableToken,\n              payableTokenName: await payableToken.name(),\n              payableTokenSymbol: await payableToken.symbol(),\n              payableTokenDecimals: (await payableToken.decimals()) || 18,\n              durationSecs: loanData.terms.durationSecs,\n              principal: loanData.terms.principal,\n              interest: loanData.terms.interest,\n            },\n            collateral: {\n              erc20: erc20Holdings,\n              erc721: erc721Holdings,\n              erc1155: erc1155Holdings,\n            },\n          });\n        }\n      }\n\n      for (let i = 0; i < numLegacyLenderNotes; i++) {\n        const lenderNoteId = await legacyLenderNote.tokenOfOwnerByIndex(\n          account,\n          i\n        );\n        const loanId = await legacyLenderNote.loanIdByNoteId(lenderNoteId);\n        const loanData = await legacyLoanCore.getLoan(loanId);\n\n        // Active state\n        if (loanData.state === 2) {\n          // const borrower = await legacyBorrowerNote.ownerOf(loanData.borrowerNoteId);\n          // Find collateral\n          const tokenId = loanData.terms.collateralTokenId;\n          const erc20Holdings = [];\n          const erc721Holdings = [];\n          const erc1155Holdings = [];\n\n          let failed = false;\n          let i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC20Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC20Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n              const decimals = await token.decimals();\n\n              erc20Holdings.push({\n                amount: holding.amount,\n                tokenAddress: holding.tokenAddress,\n                token,\n                tokenName,\n                symbol,\n                decimals,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC721Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC721Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc721Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC1155Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC1155Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc1155Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                amount: holding.amount,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          const payableToken = new ethers.Contract(\n            loanData.terms.payableCurrency,\n            ERC20Abi,\n            provider\n          );\n\n          loans.push({\n            legacy: true,\n            loanId: loanId,\n            lender: account,\n            // borrower,\n            data: {\n              state: loanData.state,\n              dueDate: loanData.dueDate.toNumber(),\n              borrowerNoteId: loanData.borrowerNoteId.toNumber(),\n              lenderNoteId: loanData.lenderNoteId.toNumber(),\n            },\n            terms: {\n              collateralTokenId: loanData.terms.collateralTokenId,\n              payableCurrency: loanData.terms.payableCurrency,\n              payableToken: payableToken,\n              payableTokenName: await payableToken.name(),\n              payableTokenSymbol: await payableToken.symbol(),\n              payableTokenDecimals: (await payableToken.decimals()) || 18,\n              durationSecs: loanData.terms.durationSecs,\n              principal: loanData.terms.principal,\n              interest: loanData.terms.interest,\n            },\n            collateral: {\n              erc20: erc20Holdings,\n              erc721: erc721Holdings,\n              erc1155: erc1155Holdings,\n            },\n          });\n        }\n      }\n\n      const info = {\n        account,\n        balances: {\n          eth: ethBalance,\n          usdc: usdcBalance,\n          weth: wethBalance,\n        },\n        loans,\n        contracts: {\n          legacyLenderNote,\n          lenderNote,\n          legacyLoanCore,\n          loanCore,\n          assetWrapper,\n          flashRollover,\n        },\n        contractAddresses: addresses,\n      };\n\n      setChainInfo((chainInfo) => Object.assign({ ...chainInfo }, info));\n    };\n\n    getInfo();\n  }, [account, provider]);\n\n  // const ethBalance = await ethers.provider.getBalance()\n\n  // For each loan, get all owned assets\n\n  // Return active loans\n  // Return contract addresses\n  return chainInfo;\n}\n","import { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\n\nimport LegacyPromissoryNoteAbi from \"./abis/legacy-promissory-note.json\";\nimport LegacyLoanCoreAbi from \"./abis/legacy-loan-core.json\";\nimport PromissoryNoteAbi from \"./abis/promissory-note.json\";\nimport LoanCoreAbi from \"./abis/loan-core.json\";\nimport AssetWrapperAbi from \"./abis/asset-wrapper.json\";\nimport FlashRolloverAbi from \"./abis/flash-rollover.json\";\nimport { useAccount, useConnect, useProvider, useSigner } from \"wagmi\";\nimport ERC20Abi from \"./abis/erc20.json\";\nimport ERC721Abi from \"./abis/erc721.json\";\nimport ERC1155Abi from \"./abis/erc1155.json\";\nimport { addresses } from \"./config\";\n// export const addresses = {\n//     legacy: {\n//         lenderNote: '0xD96e4D03420aA33a3FE91f57D03D8Ef69dE1e863',\n//         loanCore: '0x59e57F9A313A2EB1c7357eCc331Ddca14209F403',\n//         repaymentController: '0x945afF9253C840401166c3d24fF78180Fe0A05df',\n//         originationController: '0x0585a675029C68A6AF41Ba1350BC8172D6172320'\n//     },\n//     current: {\n//         lenderNote: '0x6BD1476dD1D57f08670AF6720CA2eDf37B10746E',\n//         loanCore: '0x606E4a441290314aEaF494194467Fd2Bb844064A',\n//         repaymentController: '0x9eCE636e942bCb67f9E0b7B6C51A56570EF6F38d',\n//         originationController: '0x7C2A27485B69f490945943464541236a025161F6'\n//     },\n//     common: {\n//         assetWrapper: '0x1F563CDd688ad47b75E474FDe74E87C643d129b7',\n//         flashRollover: '0x24611Fad669350cA869FBed4B62877d1a409dA12'\n//     },\n//     tokens: {\n//         usdc: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',\n//         weth: '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2'\n//     }\n// }\n\n// export const addresses = {\n//   legacy: {\n//     lenderNote: \"0xD96e4D03420aA33a3FE91f57D03D8Ef69dE1e863\",\n//     loanCore: \"0x59e57F9A313A2EB1c7357eCc331Ddca14209F403\",\n//     repaymentController: \"0x945afF9253C840401166c3d24fF78180Fe0A05df\",\n//     originationController: \"0x0585a675029C68A6AF41Ba1350BC8172D6172320\",\n//     borrowerNote: \"0x9B458e2B9c0Cd34A62A26B846f45Eb829aEbC96E\",\n//   },\n//   current: {\n//     lenderNote: \"0x6BD1476dD1D57f08670AF6720CA2eDf37B10746E\",\n//     loanCore: \"0x606E4a441290314aEaF494194467Fd2Bb844064A\",\n//     repaymentController: \"0x9eCE636e942bCb67f9E0b7B6C51A56570EF6F38d\",\n//     originationController: \"0x7C2A27485B69f490945943464541236a025161F6\",\n//     borrowerNote: \"0xe00B37ad3a165A66C20cA3E0170e4749c20eF58c\",\n//   },\n//   common: {\n//     assetWrapper: \"0x1F563CDd688ad47b75E474FDe74E87C643d129b7\",\n//     flashRollover: \"0x24611Fad669350cA869FBed4B62877d1a409dA12\",\n//   },\n//   tokens: {\n//     usdc: \"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48\",\n//     weth: \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\",\n//   },\n// };\n\nexport function usePawnBorrower() {\n  const provider = useProvider();\n  const [{ data }] = useAccount();\n\n  // const account = data?.address;\n  // const account = \"0xdba0198f9693486ef88fdc78aef40e975aad9fcb\";\n  // const account = \"0x6414258ee299b740c19a11b938afe30a373d1afd\";\n  const account = \"0xf91e3017c894e9a240972fcb7a771c355b7d2b16\";\n\n  const [chainInfo, setChainInfo] = useState(null);\n\n  useEffect(() => {\n    const getInfo = async () => {\n      if (!account) return;\n      console.log(account);\n\n      // Find active loans\n      // For lender note, check owned tokens - for each one, get the loan ID\n      // const legacyLenderNote = new ethers.Contract(\n      //   addresses.legacy.lenderNote,\n      //   LegacyPromissoryNoteAbi,\n      //   provider\n      // );\n      // const lenderNote = new ethers.Contract(\n      //   addresses.current.lenderNote,\n      //   PromissoryNoteAbi,\n      //   provider\n      // );\n      // const legacyLenderNote = new ethers.Contract(\n      //   addresses.legacy.borrowerNote,\n      //   LegacyPromissoryNoteAbi,\n      //   provider\n      // );\n      // const lenderNote = new ethers.Contract(\n      //   addresses.current.borrowerNote,\n      //   PromissoryNoteAbi,\n      //   provider\n      // );\n      const legacyBorrowerNote = new ethers.Contract(\n        addresses.legacy.borrowerNote,\n        LegacyPromissoryNoteAbi,\n        provider\n      );\n      const borrowerNote = new ethers.Contract(\n        addresses.current.borrowerNote,\n        PromissoryNoteAbi,\n        provider\n      );\n      const legacyLoanCore = new ethers.Contract(\n        addresses.legacy.loanCore,\n        LegacyLoanCoreAbi,\n        provider\n      );\n      const loanCore = new ethers.Contract(\n        addresses.current.loanCore,\n        LoanCoreAbi,\n        provider\n      );\n      const assetWrapper = new ethers.Contract(\n        addresses.common.assetWrapper,\n        AssetWrapperAbi,\n        provider\n      );\n      const flashRollover = new ethers.Contract(\n        addresses.common.flashRollover,\n        FlashRolloverAbi,\n        provider\n      );\n\n      const usdc = new ethers.Contract(\n        addresses.tokens.usdc,\n        ERC20Abi,\n        provider\n      );\n      const weth = new ethers.Contract(\n        addresses.tokens.weth,\n        ERC20Abi,\n        provider\n      );\n\n      const ethBalance = await provider.getBalance(account);\n      const usdcBalance = await usdc.balanceOf(account);\n      const wethBalance = await weth.balanceOf(account);\n\n      // const numLenderNotes = await lenderNote.balanceOf(account);\n      // const numLegacyLenderNotes = await legacyLenderNote.balanceOf(account);\n\n      const numBorrowerNote = await borrowerNote.balanceOf(account);\n      const numLegacyBorrowerNote = await legacyBorrowerNote.balanceOf(account);\n\n      console.log(\n        \"BALANCES\",\n        numBorrowerNote.toString(),\n        numLegacyBorrowerNote\n      );\n\n      const loans = [];\n      window.contracts = {\n        assetWrapper,\n        flashRollover,\n        usdc,\n        loanCore,\n        legacyLoanCore,\n        // lenderNote,\n        borrowerNote,\n      };\n      for (let i = 0; i < numBorrowerNote; i++) {\n        const lenderNoteId = await borrowerNote.tokenOfOwnerByIndex(account, i);\n        const loanId = await borrowerNote.loanIdByNoteId(lenderNoteId);\n        const loanData = await loanCore.getLoan(loanId);\n        console.log(\"BORORWER NOTE ID\", loanData.borrowerNoteId);\n\n        // Active state\n        if (loanData.state === 2) {\n          // const borrower = await borrowerNote.ownerOf(loanData.borrowerNoteId);\n          // console.log(\"BORORWER\", borrower);\n          // Find collateral\n          const tokenId = loanData.terms.collateralTokenId;\n          const erc20Holdings = [];\n          const erc721Holdings = [];\n          const erc1155Holdings = [];\n\n          let failed = false;\n          let i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC20Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC20Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n              const decimals = await token.decimals();\n\n              erc20Holdings.push({\n                amount: holding.amount,\n                tokenAddress: holding.tokenAddress,\n                token,\n                tokenName,\n                symbol,\n                decimals,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC721Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC721Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc721Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC1155Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC1155Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc1155Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                amount: holding.amount,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          const payableToken = new ethers.Contract(\n            loanData.terms.payableCurrency,\n            ERC20Abi,\n            provider\n          );\n\n          loans.push({\n            legacy: false,\n            loanId: loanId,\n            borrower: account,\n            // borrower,\n            data: {\n              state: loanData.state,\n              dueDate: loanData.dueDate.toNumber(),\n              borrowerNoteId: loanData.borrowerNoteId.toNumber(),\n              lenderNoteId: loanData.lenderNoteId.toNumber(),\n            },\n            terms: {\n              collateralTokenId: loanData.terms.collateralTokenId,\n              payableCurrency: loanData.terms.payableCurrency,\n              payableToken: payableToken,\n              payableTokenName: await payableToken.name(),\n              payableTokenSymbol: await payableToken.symbol(),\n              payableTokenDecimals: (await payableToken.decimals()) || 18,\n              durationSecs: loanData.terms.durationSecs,\n              principal: loanData.terms.principal,\n              interest: loanData.terms.interest,\n            },\n            collateral: {\n              erc20: erc20Holdings,\n              erc721: erc721Holdings,\n              erc1155: erc1155Holdings,\n            },\n          });\n        }\n      }\n\n      for (let i = 0; i < numLegacyBorrowerNote; i++) {\n        const borrowerNoteId = await legacyBorrowerNote.tokenOfOwnerByIndex(\n          account,\n          i\n        );\n        const loanId = await legacyBorrowerNote.loanIdByNoteId(borrowerNoteId);\n        const loanData = await legacyLoanCore.getLoan(loanId);\n\n        // Active state\n        if (loanData.state === 2 || loanData.state === 3) {\n          // const borrower = await legacyBorrowerNote.ownerOf(loanData.borrowerNoteId);\n          // Find collateral\n          const tokenId = loanData.terms.collateralTokenId;\n          const erc20Holdings = [];\n          const erc721Holdings = [];\n          const erc1155Holdings = [];\n\n          let failed = false;\n          let i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC20Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC20Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n              const decimals = await token.decimals();\n\n              erc20Holdings.push({\n                amount: holding.amount,\n                tokenAddress: holding.tokenAddress,\n                token,\n                tokenName,\n                symbol,\n                decimals,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC721Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC721Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc721Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          failed = false;\n          i = 0;\n          while (!failed) {\n            try {\n              const holding = await assetWrapper.bundleERC1155Holdings(\n                tokenId,\n                i++\n              );\n              const token = new ethers.Contract(\n                holding.tokenAddress,\n                ERC1155Abi,\n                provider\n              );\n              const tokenName = await token.name();\n              const symbol = await token.symbol();\n\n              erc1155Holdings.push({\n                tokenAddress: holding.tokenAddress,\n                tokenId: holding.tokenId,\n                amount: holding.amount,\n                token,\n                tokenName,\n                symbol,\n              });\n            } catch (e) {\n              failed = true;\n            }\n          }\n\n          const payableToken = new ethers.Contract(\n            loanData.terms.payableCurrency,\n            ERC20Abi,\n            provider\n          );\n\n          loans.push({\n            legacy: true,\n            loanId: loanId,\n            lender: account,\n            // borrower,\n            data: {\n              state: loanData.state,\n              dueDate: loanData.dueDate.toNumber(),\n              borrowerNoteId: loanData.borrowerNoteId.toNumber(),\n              lenderNoteId: loanData.lenderNoteId.toNumber(),\n            },\n            terms: {\n              collateralTokenId: loanData.terms.collateralTokenId,\n              payableCurrency: loanData.terms.payableCurrency,\n              payableToken: payableToken,\n              payableTokenName: await payableToken.name(),\n              payableTokenSymbol: await payableToken.symbol(),\n              payableTokenDecimals: (await payableToken.decimals()) || 18,\n              durationSecs: loanData.terms.durationSecs,\n              principal: loanData.terms.principal,\n              interest: loanData.terms.interest,\n            },\n            collateral: {\n              erc20: erc20Holdings,\n              erc721: erc721Holdings,\n              erc1155: erc1155Holdings,\n            },\n          });\n        }\n      }\n\n      const info = {\n        account,\n        balances: {\n          eth: ethBalance,\n          usdc: usdcBalance,\n          weth: wethBalance,\n        },\n        loans,\n        contracts: {\n          legacyBorrowerNote,\n          borrowerNote,\n          legacyLoanCore,\n          loanCore,\n          assetWrapper,\n          flashRollover,\n        },\n        contractAddresses: addresses,\n      };\n\n      setChainInfo((chainInfo) => Object.assign({ ...chainInfo }, info));\n    };\n\n    getInfo();\n  }, [account, provider]);\n\n  // const ethBalance = await ethers.provider.getBalance()\n\n  // For each loan, get all owned assets\n\n  // Return active loans\n  // Return contract addresses\n  return chainInfo;\n}\n","import { toast } from \"react-toastify\";\nimport {\n  useSigner,\n  useProvider,\n  useContract,\n  useWaitForTransaction,\n} from \"wagmi\";\nimport { addresses } from \"./config\";\nimport awAbi from \"./abis/asset-wrapper.json\";\n\nexport const Unwrap = ({ assetWrapperAddress, bundleId }) => {\n  const aw = addresses.custom.curatedAW;\n\n  const [{ data: signer }] = useSigner();\n  const provider = useProvider();\n\n  const awContract = useContract({\n    addressOrName: \"0xdba0198f9693486ef88fdc78aef40e975aad9fcb\",\n    contractInterface: awAbi,\n    signerOrProvider: signer,\n  });\n\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  const onWithdraw = async () => {\n    console.log(`withdraw with...${assetWrapperAddress}`);\n    try {\n      const { hash } = await awContract.withdraw(bundleId);\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Unwrapping...\",\n        success: \"Unwrap Success\",\n        error: \"Failed to unwrap\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  return (\n    <div>\n      <h2>Withdraw</h2>\n      <button onClick={onWithdraw} style={{ background: \"white\" }}>\n        UnWrap ID: {bundleId}\n      </button>\n    </div>\n  );\n};\n","import RepaymentControllerAbi from \"./abis/repayment-controller.json\";\nimport { useSigner, useContract, erc20ABI, useWaitForTransaction } from \"wagmi\";\nimport { useApproveERC20 } from \"./useApproveERC20\";\nimport { toast } from \"react-toastify\";\nimport { addresses } from \"./config\";\n\nexport const usePayLoan = ({\n  payableCurrency,\n  borrowerNoteId,\n  repaymentController,\n}) => {\n  const [{ data: signer }] = useSigner();\n\n  const { doApprove } = useApproveERC20({\n    tokenAddress: payableCurrency,\n    spender: repaymentController,\n  });\n  const repaymentContract = useContract({\n    addressOrName: repaymentController,\n    contractInterface: RepaymentControllerAbi,\n    signerOrProvider: signer,\n  });\n\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  const doRepay = async () => {\n    // approve repayment controller spending payable currency\n    // await doApprove();\n\n    console.log(`repaying with...${addresses.target.repaymentController}`);\n    try {\n      const { hash } = await repaymentContract.repay(borrowerNoteId);\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Repaying...\",\n        success: \"Repaid\",\n        error: \"Failed to repay\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  return { doRepay };\n};\n","import { useEffect } from \"react\";\nimport { useSigner, useContract, erc20ABI, useWaitForTransaction } from \"wagmi\";\nimport { addresses } from \"./config\";\nimport { toast } from \"react-toastify\";\nimport { ethers } from \"ethers\";\n\nexport const useApproveERC20 = ({ tokenAddress, spender }) => {\n  const [{ data: signer }] = useSigner();\n  const erc20Contract = useContract({\n    addressOrName: tokenAddress,\n    contractInterface: erc20ABI,\n    signerOrProvider: signer,\n  });\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  const doApprove = async () => {\n    console.log(`approving ${spender} to spend ${tokenAddress}`);\n    try {\n      const { hash } = await erc20Contract.approve(\n        spender,\n        ethers.constants.MaxInt256\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving ERC20...\",\n        success: \"ERC20 Approved\",\n        error: \"Failed to Approve ERC20\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  return { doApprove };\n};\n","import { useState } from \"react\";\nimport { CollateralList, RolloverSigningForm } from \"./App\";\nimport { useSigner, useContract, useWaitForTransaction } from \"wagmi\";\nimport { addresses } from \"./config\";\nimport promissoryNoteAbi from \"./abis/promissory-note.json\";\nimport { toast } from \"react-toastify\";\nimport { ethers } from \"ethers\";\nimport { usePayLoan } from \"./usePayLoan\";\n\nexport const BorrowerLoanCard = ({ loan, index: key, chainInfo }) => {\n  const { loanId, terms, data, legacy } = loan;\n  const [showRollover, setShowRollover] = useState(false);\n  const [{ data: signer }] = useSigner();\n  console.log({ loan });\n  const { doRepay } = usePayLoan({\n    payableCurrency: terms?.payableCurrency,\n    borrowerNoteId: data?.borrowerNoteId,\n    repaymentController: addresses?.current?.repaymentController,\n  });\n\n  const borrowerNoteLookupKey = legacy ? \"legacy\" : \"current\";\n\n  const borrowerNoteContract = useContract({\n    addressOrName: addresses[borrowerNoteLookupKey].borrowerNote,\n    contractInterface: promissoryNoteAbi,\n    signerOrProvider: signer,\n  });\n\n  // eslint-disable-next-line no-unused-vars\n  const [_, wait] = useWaitForTransaction({\n    skip: true,\n  });\n\n  const approveNote = async (noteId) => {\n    console.log(\n      `approving Note ID ...${addresses.target.flashRollover} noteId ${noteId}`\n    );\n    try {\n      const { hash } = await borrowerNoteContract.approve(\n        addresses.target.flashRollover,\n        noteId\n      );\n\n      const waitForApproval = wait({ confirmations: 1, hash });\n      const response = await toast.promise(waitForApproval, {\n        pending: \"Approving Borrower Note...\",\n        success: \"Note Approved\",\n        error: \"Failed to Approve Note\",\n      });\n\n      console.log({ response });\n    } catch (e) {\n      toast.error(e);\n    }\n  };\n\n  return (\n    <div className=\"loan card\" key={key}>\n      <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n        <button\n          style={{ background: \"white\" }}\n          onClick={() => approveNote(loan?.data?.borrowerNoteId)}\n          disabled={!loan?.data?.borrowerNoteId}\n        >{`Approve Note ${loan?.data?.borrowerNoteId}`}</button>\n        <button style={{ background: \"white\" }} onClick={() => doRepay()}>\n          Pay Loan {loan?.data?.borrowerNoteId}\n        </button>\n      </div>\n      <h5 className=\"bold\">\n        Loan ID {loanId.toString()}\n        {loan.legacy && ` (Legacy)`}\n      </h5>\n      <p>\n        <strong>State:</strong>\n        {loan?.data?.state === 2 ? \" active\" : \" repaid\"}\n      </p>\n      <p>\n        <strong>Borrower:</strong> {loan.borrower}\n      </p>\n      <p>\n        <strong>Principal:</strong>{\" \"}\n        {ethers.utils.formatUnits(terms.principal, terms.payableTokenDecimals)}{\" \"}\n        {terms.payableTokenSymbol}\n      </p>\n      <p>\n        <strong>Interest:</strong>{\" \"}\n        {ethers.utils.formatUnits(terms.interest, terms.payableTokenDecimals)}{\" \"}\n        {terms.payableTokenSymbol}\n      </p>\n      <CollateralList loanId={loanId} collateral={loan.collateral} />\n      {/* <p>\n        <strong>\n          <DueDate ts={data.dueDate} />\n        </strong>\n      </p> */}\n      <p>\n        <strong>\n          <a\n            className=\"rollover toggle\"\n            onClick={() => setShowRollover(!showRollover)}\n          >\n            {showRollover ? \"Hide\" : \"Rollover Loan\"}\n          </a>\n        </strong>\n      </p>\n      {showRollover && (\n        <RolloverSigningForm\n          loan={loan}\n          oldTerms={terms}\n          chainInfo={chainInfo}\n        />\n      )}\n    </div>\n  );\n};\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './normalize.css';\nimport './skeleton.css';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}